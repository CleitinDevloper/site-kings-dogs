<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.5, minimum-scale=0.3, maximum-scale=3.0, user-scalable=yes">
    <title>Painel Administrativo</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' https://static.cloudflareinsights.com;">

    <style>
        /* Auto-formatação responsiva com % para larguras, margens e espaçamentos */
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            width: 100%;
        }
    
        /* Navbar custom (sem Bootstrap) */
        .navbar {
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 1% 0;
            width: 100%;
        }
    
        .navbar .container {
            max-width: 90%;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    
        .navbar-brand {
            font-weight: bold;
            color: #007bff !important;
            text-decoration: none;
            font-size: 1.5em;
        }
    
        /* Container principal */
        .container {
            max-width: 90%;
            margin: 2% auto;
            padding: 0 2%;
        }
    
        /* Tabs custom (sem Bootstrap) */
        .nav {
            display: flex;
            list-style: none;
            padding: 0;
            margin: 0 0 2%;
            border-bottom: 1px solid #dee2e6;
            width: 100%;
        }
    
        .nav-item {
            margin-right: 0.5%;
            flex: 1;
        }
    
        .nav-link {
            background: none;
            border: none;
            padding: 1% 2%;
            cursor: pointer;
            width: 100%;
            text-align: center;
            border: 1px solid transparent;
            border-bottom: none;
            transition: all 0.3s;
            color: #495057;
        }
    
        .nav-link.active {
            border-color: #007bff;
            color: #007bff;
            border-bottom: 2px solid #007bff;
        }
    
        .nav-link:hover {
            background-color: #f8f9fa;
        }
    
        /* Tab content */
        .tab-content {
            width: 100%;
            padding: 2% 0;
        }
    
        .tab-pane {
            display: none;
            width: 100%;
        }
    
        .tab-pane.show.active {
            display: block;
        }
    
        .tab-pane.fade {
            opacity: 0;
            transition: opacity 0.3s;
        }
    
        .tab-pane.show.active.fade {
            opacity: 1;
        }
    
        /* Row e Colunas responsivas com % */
        .row {
            display: flex;
            flex-wrap: wrap;
            width: 100%;
            margin: 2% 0;
        }
    
        .col-md-4 {
            flex: 0 0 33.333333%;
            /* 1/3 da largura em telas médias+ */
            max-width: 33.333333%;
            padding: 0 1%;
            box-sizing: border-box;
        }
    
        .col-md-2 {
            flex: 0 0 16.666667%;
            /* 1/6 */
            max-width: 16.666667%;
            padding: 0 1%;
        }
    
        .col-md-3 {
            flex: 0 0 25%;
            /* 1/4 */
            max-width: 25%;
            padding: 0 1%;
        }
    
        .col-md-6 {
            flex: 0 0 50%;
            /* 1/2 */
            max-width: 50%;
            padding: 0 1%;
        }
    
        @media (max-width: 768px) {
    
            .col-md-4,
            .col-md-2,
            .col-md-3,
            .col-md-6 {
                flex: 0 0 100%;
                max-width: 100%;
            }
        }
    
        /* Cards */
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
            width: 100%;
            background: #fff;
        }
    
        .card:hover {
            transform: translateY(-5px);
        }
    
        .card-body {
            padding: 3% 5%;
        }
    
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
        }
    
        .ranking-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
    
        .card-title {
            margin: 0 0 2%;
            font-size: 1.2em;
        }
    
        /* Flex utilities */
        .d-flex {
            display: flex;
        }
    
        .justify-content-between {
            justify-content: space-between;
        }
    
        .align-items-center {
            align-items: center;
        }
    
        .me-2 {
            margin-right: 2%;
        }
    
        .mt-4 {
            margin-top: 3%;
        }
    
        .mb-3 {
            margin-bottom: 2%;
        }
    
        /* Search bar */
        .search-bar {
            background: white;
            border-radius: 25px;
            padding: 1% 2%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            flex: 1;
            max-width: 40%;
        }
    
        .form-control {
            border: 1px solid #ced4da;
            border-radius: 10px;
            padding: 1% 2%;
            width: 70%;
            box-sizing: border-box;
        }
    
        /* Buttons custom */
        .btn {
            border: none;
            padding: 1% 2%;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
            width: auto;
        }
    
        .btn-custom {
            border-radius: 25px;
            padding: 1% 3%;
        }
    
        .btn-success {
            background-color: #28a745;
            color: white;
        }
    
        .btn-success:hover {
            background-color: #218838;
        }
    
        .btn-outline-primary {
            background: transparent;
            border: 1px solid #007bff;
            color: #007bff;
        }
    
        .btn-outline-primary:hover {
            background-color: #007bff;
            color: white;
        }
    
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
    
        .btn-danger:hover {
            background-color: #c82333;
        }
    
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
    
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
    
        .btn-sm {
            padding: 0.5% 1%;
            font-size: 0.9em;
        }
    
        .btn-close {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #999;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    
        /* Form elements */
        .form-label {
            display: block;
            margin-bottom: 1%;
            font-weight: bold;
        }
    
        .form-check {
            display: flex;
            align-items: center;
        }
    
        .form-check-input {
            margin-right: 0.5%;
            width: 1.2em;
            height: 1.2em;
        }
    
        .form-check-label {
            margin: 0;
        }
    
        input[type="number"] {
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 1% 2%;
            width: 100%;
            box-sizing: border-box;
        }
    
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    
        /* Modals custom (sem Bootstrap) */
        .modal {
            display: none;
            position: fixed;
            z-index: 1050;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }
    
        .modal.show {
            display: block;
        }
    
        .modal-dialog {
            margin: 10% auto;
            width: 80%;
            max-width: 800px;
            /* Para modal-lg */
        }
    
        .modal-dialog.modal-dialog {
            /* Default para addEmployeeModal */
            width: 50%;
        }
    
        .modal-content {
            background-color: #fff;
            border-radius: 15px;
            border: none;
            width: 100%;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    
        .modal-header {
            padding: 2% 3%;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    
        .modal-title {
            margin: 0;
            font-size: 1.5em;
        }
    
        .modal-body {
            padding: 3%;
        }
    
        .modal-footer {
            padding: 2% 3%;
            border-top: 1px solid #dee2e6;
            display: flex;
            justify-content: flex-end;
            gap: 2%;
        }
    
        /* Item e Observation rows */
        .item-row,
        .observation-row {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 2%;
            margin-bottom: 2%;
        }
    
        /* Badge */
        .badge {
            padding: 0.5% 1%;
            border-radius: 10px;
            font-size: 0.8em;
            color: white;
        }
    
        .bg-success {
            background-color: #28a745;
        }
    
        .bg-warning {
            background-color: #ffc107;
            color: #000;
        }
    
        /* Text utilities */
        .text-center {
            text-align: center;
        }
    
        .text-white {
            color: white;
        }
    
        .text-muted {
            color: #6c757d;
        }
    
        /* Ol para ranking */
        ol {
            padding-left: 2%;
            margin: 0;
        }
    
        ol li {
            margin-bottom: 1%;
        }
    
        /* Responsividade geral */
        @media (max-width: 768px) {
            .container {
                max-width: 95%;
                padding: 0 1%;
            }
    
            .nav {
                flex-direction: column;
            }
    
            .nav-item {
                margin: 0.5% 0;
            }
    
            .search-bar {
                max-width: 100%;
                margin-bottom: 2%;
            }
    
            .d-flex.justify-content-between {
                flex-direction: column;
                gap: 2%;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-building"></i> Painel Administrativo</a>
        </div>
    </nav>

    <div class="container">
        <ul class="nav" id="adminTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="metrics-tab" type="button" role="tab" aria-controls="metrics" aria-selected="true" onclick="switchTab('metrics')">
                    <i class="fas fa-chart-line"></i> Métricas
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="orders-tab" type="button" role="tab" aria-controls="orders" aria-selected="false" onclick="switchTab('orders')">
                    <i class="fas fa-shopping-cart"></i> Pedidos
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="employees-tab" type="button" role="tab" aria-controls="employees" aria-selected="false" onclick="switchTab('employees')">
                    <i class="fas fa-users"></i> Funcionários
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="products-tab" type="button" role="tab" aria-controls="products" aria-selected="false" onclick="switchTab('products')">
                    <i class="fas fa-box"></i> Produtos
                </button>
            </li>
        </ul>

        <div class="tab-content" id="adminTabsContent">
            <!-- Métricas Tab -->
            <div class="tab-pane fade show active" id="metrics" role="tabpanel" aria-labelledby="metrics-tab">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card metric-card text-center">
                            <div class="card-body">
                                <h5 class="card-title"><i class="fas fa-shopping-bag"></i> Número de Pedidos</h5>
                                <h2 id="totalOrders">0</h2>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card metric-card text-center">
                            <div class="card-body">
                                <h5 class="card-title"><i class="fas fa-dollar-sign"></i> Valor Ganho</h5>
                                <h2 id="totalValue">R$ 0,00</h2>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card ranking-card">
                            <div class="card-body">
                                <h5 class="card-title"><i class="fas fa-trophy"></i> Ranking de Vendas</h5>
                                <ol id="salesRanking" class="text-white">
                                    <li>João Silva - R$ 5.000</li>
                                    <li>Maria Santos - R$ 4.200</li>
                                    <li>Pedro Oliveira - R$ 3.800</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pedidos Tab -->
            <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
                <div class="d-flex justify-content-between align-items-center mt-4">
                    <div class="search-bar d-flex">
                        <input type="text" id="orderSearch" class="form-control me-2" placeholder="Buscar por nome ou número do pedido">
                        <button class="btn btn-outline-primary" onclick="searchOrders()"><i class="fas fa-search"></i></button>
                    </div>
                    <button class="btn btn-success btn-custom" onclick="openModal('addOrderModal')">
                        <i class="fas fa-plus"></i> Novo Pedido
                    </button>
                </div>
                <div id="ordersList" class="mt-4">
                    <!-- Orders will be populated here -->
                </div>
            </div>

            <!-- Funcionários Tab -->
            <div class="tab-pane fade" id="employees" role="tabpanel" aria-labelledby="employees-tab">
                <div class="d-flex justify-content-between align-items-center mt-4">
                    <div class="search-bar d-flex">
                        <input type="text" id="employeeSearch" class="form-control me-2" placeholder="Buscar por nome ou número">
                        <button class="btn btn-outline-primary" onclick="searchEmployees()"><i class="fas fa-search"></i></button>
                    </div>
                    <button class="btn btn-success btn-custom" onclick="openModal('addEmployeeModal')">
                        <i class="fas fa-user-plus"></i> Contratar Funcionário
                    </button>
                </div>
                <div id="employeesList" class="mt-4">
                    <!-- Employees will be populated here -->
                </div>
            </div>

            <!-- Produtos Tab -->
            <div class="tab-pane fade" id="products" role="tabpanel" aria-labelledby="products-tab">
                <div id="productsList" class="mt-4 row">
                    <!-- Products will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div class="modal" id="orderDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalhes do Pedido</h5>
                    <button type="button" class="btn-close" onclick="closeModal('orderDetailsModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="orderDetails">
                        <!-- Order details will be populated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" onclick="deliverOrder()">PEDIDO ENTREGUE</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Order Modal -->
    <div class="modal" id="addOrderModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Novo Pedido</h5>
                    <button type="button" class="btn-close" onclick="closeModal('addOrderModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="addOrderForm">
                        <div class="mb-3">
                            <label for="customerName" class="form-label">Nome do Cliente</label>
                            <input type="text" class="form-control" id="customerName">
                            " required>
                        </div>
                        <div class="mb-3">
                            <label for="orderNumber" class="form-label">Número do Pedido</label>
                            <input type="text" class="form-control" id="orderNumber" required>
                        </div>
                        <div id="itemsContainer">
                            <h6>Itens do Pedido</h6>
                            <div class="item-row mb-3">
                                <div class="row">
                                    <div class="col-md-4">
                                        <input type="text" class="form-control" placeholder="Nome do Item" required>
                                    </div>
                                    <div class="col-md-2">
                                        <input type="number" class="form-control" placeholder="Qtd" required>
                                    </div>
                                    <div class="col-md-3">
                                        <input type="number" step="0.01" class="form-control" placeholder="Preço" required>
                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" class="btn btn-danger btn-sm" onclick="removeItem(this)">Remover</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm mb-3" onclick="addItem()">Adicionar Item</button>
                        <div id="observationsContainer">
                            <h6>Observações</h6>
                            <div class="observation-row mb-3">
                                <div class="row">
                                    <div class="col-md-6">
                                        <input type="text" class="form-control" placeholder="Nome da Observação" required>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="obsStatus" value="Não" required>
                                            <label class="form-check-label">Não</label>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="obsStatus" value="Sim">
                                            <label class="form-check-label">Sim</label>
                                        </div>
                                        <button type="button" class="btn btn-danger btn-sm" onclick="removeObservation(this)">Remover</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm mb-3" onclick="addObservation()">Adicionar Observação</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addOrderModal')">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveOrder()">Salvar Pedido</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div class="modal" id="addEmployeeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Contratar Funcionário</h5>
                    <button type="button" class="btn-close" onclick="closeModal('addEmployeeModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="addEmployeeForm">
                        <div class="mb-3">
                            <label for="employeeName" class="form-label">Nome do Funcionário</label>
                            <input type="text" class="form-control" id="employeeName" required>
                        </div>
                        <div class="mb-3">
                            <label for="employeeNumber" class="form-label">Número do Funcionário</label>
                            <input type="text" class="form-control" id="employeeNumber" required>
                        </div>
                        <div class="mb-3">
                            <label for="employeePosition" class="form-label">Cargo</label>
                            <input type="text" class="form-control" id="employeePosition" required>
                        </div>
                        <div class="mb-3">
                            <label for="employeeSalary" class="form-label">Salário</label>
                            <input type="number" step="0.01" class="form-control" id="employeeSalary" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addEmployeeModal')">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveEmployee()">Contratar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Funções JS para funcionalidade sem Bootstrap (evita CSP com classes)
        let orders = [
            { id: 1, customer: 'João Silva', number: 'PED001', items: [{ name: 'Produto A', qty: 2, price: 50 }, { name: 'Produto B', qty: 1, price: 30 }], observations: [{ name: 'Pure de batata', status: 'Não' }, { name: 'Sem cebola', status: 'Sim' }], delivered: false },
            { id: 2, customer: 'Maria Santos', number: 'PED002', items: [{ name: 'Produto C', qty: 3, price: 20 }], observations: [{ name: 'Extra queijo', status: 'Não' }], delivered: false }
        ];

        let employees = [
            { id: 1, name: 'João Silva', number: 'EMP001', ordersDelivered: 15, position: 'Vendedor' },
            { id: 2, name: 'Maria Santos', number: 'EMP002', ordersDelivered: 12, position: 'Vendedor' },
            { id: 3, name: 'Pedro Oliveira', number: 'EMP003', ordersDelivered: 10, position: 'Vendedor' }
        ];

        let products = [
            { id: 1, name: 'Produto 1', image: 'https://via.placeholder.com/250x150?text=Produto+1', quantity: 10 },
            { id: 2, name: 'Produto 2', image: 'https://via.placeholder.com/250x150?text=Produto+2', quantity: 5 },
            { id: 3, name: 'Produto 3', image: 'https://via.placeholder.com/250x150?text=Produto+3', quantity: 20 }
        ];

        // Inicialização
        document.addEventListener('DOMContentLoaded', function () {
            token = localStorage.getItem("token");
            if (!token) {
                window.location.href = "/";
                return;
            }
            updateMetrics();
            renderOrders();
            renderEmployees();
            renderProducts();
            // Configurar tabs iniciais
            switchTab('metrics');
        });

        // Função para alternar tabs (sem Bootstrap)
        function switchTab(tabId) {
            // Esconder todas as tabs
            const tabs = document.querySelectorAll('.tab-pane');
            tabs.forEach(tab => {
                tab.classList.remove('show', 'active', 'fade');
            });
            // Remover active dos links
            const links = document.querySelectorAll('.nav-link');
            links.forEach(link => link.classList.remove('active'));
            // Mostrar tab selecionada
            const activeTab = document.getElementById(tabId);
            activeTab.classList.add('show', 'active', 'fade');
            // Ativar link
            const activeLink = document.getElementById(tabId + '-tab');
            activeLink.classList.add('active');
        }

        // Funções para modals (sem Bootstrap)
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('show');
            document.body.style.overflow = 'hidden'; // Previne scroll
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // Fechar modal ao clicar fora
        window.onclick = function (event) {
            if (event.target.classList.contains('modal')) {
                closeModal(event.target.id);
            }
        }

        function updateMetrics() {
            document.getElementById('totalOrders').textContent = orders.length;
            let totalValue = orders.reduce((sum, order) => sum + order.items.reduce((itemSum, item) => itemSum + (item.qty * item.price), 0), 0);
            document.getElementById('totalValue').textContent = 'R$ ' + totalValue.toFixed(2).replace('.', ',');
        }

        function renderOrders() {
            const ordersList = document.getElementById('ordersList');
            ordersList.innerHTML = '';
            orders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.className = 'order-item';
                orderDiv.onclick = () => showOrderDetails(order.id);
                orderDiv.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6>${order.customer}</h6>
                                <small class="text-muted">Pedido: ${order.number}</small>
                            </div>
                            <span class="badge ${order.delivered ? 'bg-success' : 'bg-warning'}">${order.delivered ? 'Entregue' : 'Pendente'}</span>
                        </div>
                    `;
                ordersList.appendChild(orderDiv);
            });
        }

        function renderEmployees() {
            const employeesList = document.getElementById('employeesList');
            employeesList.innerHTML = '';
            employees.forEach(employee => {
                const employeeDiv = document.createElement('div');
                employeeDiv.className = 'employee-item';
                employeeDiv.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6>${employee.name}</h6>
                                <small class="text-muted">Número: ${employee.number} | Pedidos: ${employee.ordersDelivered}</small>
                            </div>
                            <div>
                                <button class="btn btn-outline-danger btn-sm me-2" onclick="event.stopPropagation(); fireEmployee(${employee.id})">Demitir</button>
                                <button class="btn btn-outline-success btn-sm" onclick="event.stopPropagation(); promoteEmployee(${employee.id})">Promover</button>
                            </div>
                        </div>
                    `;
                employeesList.appendChild(employeeDiv);
            });
        }

        function renderProducts() {
            const productsList = document.getElementById('productsList');
            productsList.innerHTML = '';
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'product-item col-md-4 mb-4';
                productDiv.innerHTML = `
                        <div class="card">
                            <img src="${product.image}" class="card-img-top" alt="${product.name}" style="width: 100%; height: auto;">
                            <div class="card-body text-center">
                                <h5 class="card-title">${product.name}</h5>
                                <div class="quantity-selector">
                                    <button class="btn btn-outline-secondary" onclick="changeQuantity(${product.id}, -1)">-</button>
                                    <span class="mx-3" id="qty-${product.id}">${product.quantity}</span>
                                    <button class="btn btn-outline-secondary" onclick="changeQuantity(${product.id}, 1)">+</button>
                                </div>
                            </div>
                        </div>
                    `;
                productsList.appendChild(productDiv);
            });
        }

        function changeQuantity(id, delta) {
            const product = products.find(p => p.id === id);
            product.quantity = Math.max(0, product.quantity + delta);
            document.getElementById(`qty-${id}`).textContent = product.quantity;
        }

        function showOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            const detailsDiv = document.getElementById('orderDetails');
            detailsDiv.innerHTML = `
                    <h6>Cliente: ${order.customer}</h6>
                    <p>Número: ${order.number}</p>
                    <h6>Itens:</h6>
                    <ul>
                        ${order.items.map(item => `<li>${item.name} - Qtd: ${item.qty} - Preço: R$ ${item.price.toFixed(2).replace('.', ',')}</li>`).join('')}
                    </ul>
                    <h6>Observações:</h6>
                    <ul>
                        ${order.observations.map(obs => `
                            <li>${obs.name}: 
                                <input type="checkbox" ${obs.status === 'Não' ? 'checked' : ''} disabled> Não
                                <input type="checkbox" ${obs.status === 'Sim' ? 'checked' : ''} disabled> Sim
                            </li>
                        `).join('')}
                    </ul>
                `;
            openModal('orderDetailsModal');
        }

        function deliverOrder() {
            alert('Pedido marcado como entregue!');
            closeModal('orderDetailsModal');
            updateMetrics();
            // Atualize status no array se necessário
            const modal = document.getElementById('orderDetailsModal');
            const orderId = /* Pegue do contexto ou passe como param */ 1; // Exemplo
            const order = orders.find(o => o.id === orderId);
            if (order) order.delivered = true;
            renderOrders();
        }

        function searchOrders() {
            const searchTerm = document.getElementById('orderSearch').value.toLowerCase();
            const filteredOrders = orders.filter(order =>
                order.customer.toLowerCase().includes(searchTerm) ||
                order.number.toLowerCase().includes(searchTerm)
            );
            // Render filtered (simplificado; atualize orders temp)
            orders = filteredOrders; // Para demo; use var temp em prod
            renderOrders();
        }

        function searchEmployees() {
            const searchTerm = document.getElementById('employeeSearch').value.toLowerCase();
            const filteredEmployees = employees.filter(employee =>
                employee.name.toLowerCase().includes(searchTerm) ||
                employee.number.toLowerCase().includes(searchTerm)
            );
            employees = filteredEmployees; // Para demo
            renderEmployees();
        }

        function addItem() {
            const container = document.getElementById('itemsContainer');
            const newItem = document.createElement('div');
            newItem.className = 'item-row mb-3';
            newItem.innerHTML = `
                    <div class="row">
                        <div class="col-md-4">
                            <input type="text" class="form-control" placeholder="Nome do Item" required>
                        </div>
                        <div class="col-md-2">
                            <input type="number" class="form-control" placeholder="Qtd" required>
                        </div>
                        <div class="col-md-3">
                            <input type="number" step="0.01" class="form-control" placeholder="Preço" required>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-danger btn-sm" onclick="removeItem(this)">Remover</button>
                        </div>
                    </div>
                `;
            container.appendChild(newItem);
        }

        function removeItem(button) {
            button.closest('.item-row').remove();
        }

        function addObservation() {
            const container = document.getElementById('observationsContainer');
            const newObs = document.createElement('div');
            newObs.className = 'observation-row mb-3';
            newObs.innerHTML = `
                    <div class="row">
                        <div class="col-md-6">
                            <input type="text" class="form-control" placeholder="Nome da Observação" required>
                        </div>
                        <div class="col-md-3">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="obsStatus_${Date.now()}" value="Não" required> <!-- Nome único para radios -->
                                <label class="form-check-label">Não</label>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="obsStatus_${Date.now()}" value="Sim">
                                <label class="form-check-label">Sim</label>
                            </div>
                            <button type="button" class="btn btn-danger btn-sm" onclick="removeObservation(this)">Remover</button>
                        </div>
                    </div>
                `;
            container.appendChild(newObs);
        }

        function removeObservation(button) {
            button.closest('.observation-row').remove();
        }

        function saveOrder() {
            // Coleta dados do form (exemplo simples; expanda para itens/obs)
            const customerName = document.getElementById('customerName').value;
            const orderNumber = document.getElementById('orderNumber').value;
            // ... Colete itens e obs dinamicamente
            alert(`Pedido salvo: ${customerName} - ${orderNumber}`);
            closeModal('addOrderModal');
            // Limpe form
            document.getElementById('addOrderForm').reset();
            document.getElementById('itemsContainer').innerHTML = '<h6>Itens do Pedido</h6><div class="item-row mb-3"><div class="row"><!-- item inicial --></div></div>'; // Recrie inicial
            document.getElementById('observationsContainer').innerHTML = '<h6>Observações</h6><div class="observation-row mb-3"><div class="row"><!-- obs inicial --></div></div>';
            updateMetrics();
            renderOrders();
        }

        function saveEmployee() {
            const name = document.getElementById('employeeName').value;
            const number = document.getElementById('employeeNumber').value;
            // ... Outros campos
            alert(`Funcionário contratado: ${name} - ${number}`);
            closeModal('addEmployeeModal');
            document.getElementById('addEmployeeForm').reset();
            renderEmployees();
        }

        function fireEmployee(id) {
            if (confirm('Tem certeza que deseja demitir este funcionário?')) {
                employees = employees.filter(emp => emp.id !== id);
                renderEmployees();
            }
        }
        function promoteEmployee(id) {
            alert('Funcionário promovido!');
            // Em app real, atualize cargo no DB
            const employee = employees.find(emp => emp.id === id);
            if (employee) {
                employee.position = 'Gerente'; // Exemplo
                renderEmployees();
            }
        }
    </script>
</body>
</html>
